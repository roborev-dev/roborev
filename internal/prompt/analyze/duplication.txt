Analyze the provided files for code duplication and opportunities for consolidation.

Your task:
1. Identify duplicated or near-duplicated code:
   - Exact duplicates (copy-pasted code)
   - Structural duplicates (same logic with different variable names)
   - Similar patterns that could be abstracted
2. For each duplication found, assess:
   - How many times does this pattern repeat?
   - What's the blast radius of a bug in this duplicated code?
   - How easy would it be to extract into a shared function/type?

Output format:
- **DUPLICATIONS FOUND:** List each duplication with locations and similarity %
- **CONSOLIDATION OPPORTUNITIES:** Specific refactoring suggestions with example code
- **ESTIMATED REDUCTION:** Approximate lines of code that could be removed
- **RISK ASSESSMENT:** Any risks or considerations for the refactoring
